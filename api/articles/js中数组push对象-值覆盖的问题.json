{"title":"js中数组push对象,值覆盖的问题","slug":"js中数组push对象-值覆盖的问题","date":"2018-05-09T01:36:18.000Z","updated":"2018-11-19T10:01:52.354Z","comments":true,"excerpt":"","content":"<h2 id=\"前言\"><a href=\"#前言\" class=\"headerlink\" title=\"前言\"></a>前言</h2><p>昨天在写微信小程序时，在遍历图片数组并将其转为对象重新push进去的时候遇到一个问题，每次往数组push对象，后一次的对象都会覆盖前一次push进去的值。后来经过万能的百度，终于发现问题了</p>\n<h2 id=\"正文\"><a href=\"#正文\" class=\"headerlink\" title=\"正文\"></a>正文</h2><p>原因：外层定义的对象，每次赋值地址都是一样的，数组中push进去的其实是对象的地址，因此push进去的值都相同。<br>解决方法：在循环里面定义对象</p>\n<h3 id=\"错误代码示例\"><a href=\"#错误代码示例\" class=\"headerlink\" title=\"错误代码示例\"></a>错误代码示例</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var data = &#123; a:<span class=\"string\">'123'</span>, b: <span class=\"string\">'456'</span>, c: <span class=\"string\">'789'</span>&#125;;  </span><br><span class=\"line\">var dataObj = &#123;&#125;;//在外面定义对象  </span><br><span class=\"line\">var dataArr = [];  </span><br><span class=\"line\"><span class=\"keyword\">for</span>(var i <span class=\"keyword\">in</span> data) &#123;  </span><br><span class=\"line\">    dataObj.name= data[i];  </span><br><span class=\"line\">    dataArr.push(dataObj);  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">console.log(dataArr);</span><br></pre></td></tr></table></figure>\n<p>此时输出结果为：789,789,789</p>\n<h3 id=\"正确写法\"><a href=\"#正确写法\" class=\"headerlink\" title=\"正确写法\"></a>正确写法</h3><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var data = &#123; a:<span class=\"string\">'123'</span>, b: <span class=\"string\">'456'</span>, c: <span class=\"string\">'789'</span>&#125;;  </span><br><span class=\"line\">var dataArr = [];  </span><br><span class=\"line\"><span class=\"keyword\">for</span>(var i indata)&#123;  </span><br><span class=\"line\">var dataObj = &#123;&#125;;//在里面定义对象  </span><br><span class=\"line\">    dataObj.name= data[i];  </span><br><span class=\"line\">    dataArr.push(dataObj);  </span><br><span class=\"line\">&#125;  </span><br><span class=\"line\">console.log(dataArr);</span><br></pre></td></tr></table></figure>\n<p>此时输出结果为：123,456,789</p>\n","categories":[],"tags":[]}