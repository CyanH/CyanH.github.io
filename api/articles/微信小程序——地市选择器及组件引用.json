{"title":"微信小程序——地市选择器及组件引用","slug":"微信小程序——地市选择器及组件引用","date":"2018-05-29T06:12:14.000Z","updated":"2018-11-19T10:01:52.394Z","comments":true,"excerpt":"","content":"<p>之前使用了小程序官方的地区选择器（组件picker），用法如下<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;view class=<span class=\"string\">\"section\"</span>&gt;</span><br><span class=\"line\">  &lt;view class=<span class=\"string\">\"section__title\"</span>&gt;省市区选择器&lt;/view&gt;</span><br><span class=\"line\">  &lt;picker mode=<span class=\"string\">\"region\"</span> bindchange=<span class=\"string\">\"bindRegionChange\"</span> value=<span class=\"string\">\"&#123;&#123;region&#125;&#125;\"</span> custom-item=<span class=\"string\">\"&#123;&#123;customItem&#125;&#125;\"</span>&gt;</span><br><span class=\"line\">    &lt;view class=<span class=\"string\">\"picker\"</span>&gt;</span><br><span class=\"line\">      当前选择：&#123;&#123;region[0]&#125;&#125;，&#123;&#123;region[1]&#125;&#125;，&#123;&#123;region[2]&#125;&#125;</span><br><span class=\"line\">    &lt;/view&gt;</span><br><span class=\"line\">  &lt;/picker&gt;</span><br><span class=\"line\">&lt;/view&gt;</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Page(&#123;</span><br><span class=\"line\">    data: &#123;</span><br><span class=\"line\">        region: [<span class=\"string\">'广东省'</span>, <span class=\"string\">'广州市'</span>, <span class=\"string\">'海珠区'</span>],</span><br><span class=\"line\">        customItem: <span class=\"string\">'全部'</span></span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    bindRegionChange: <span class=\"keyword\">function</span> (e) &#123;</span><br><span class=\"line\">      console.log(<span class=\"string\">'picker发送选择改变，携带值为'</span>, e.detail.value)</span><br><span class=\"line\">      this.setData(&#123;</span><br><span class=\"line\">        region: e.detail.value</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<p>默认的地区选择器是省市县三级的，但是因为要求只需要省市两级的，只好自己重新做了。<br>思路是：<br>1、使用多项选择器<br>2、自己构造地市数据</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">citys.js</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var citys = &#123;</span><br><span class=\"line\">  <span class=\"string\">'北京市'</span>: [<span class=\"string\">'市辖区'</span>],</span><br><span class=\"line\">  <span class=\"string\">'天津市'</span>: [<span class=\"string\">'市辖区'</span>],</span><br><span class=\"line\">  <span class=\"string\">'河北省'</span>: [<span class=\"string\">'石家庄市'</span>, <span class=\"string\">'唐山市'</span>, <span class=\"string\">'秦皇岛市'</span>, <span class=\"string\">'邯郸市'</span>, <span class=\"string\">'邢台市'</span>, <span class=\"string\">'保定市'</span>, <span class=\"string\">'张家口市'</span>, <span class=\"string\">'承德市'</span>, <span class=\"string\">'沧州市'</span>, <span class=\"string\">'廊坊市'</span>, <span class=\"string\">'衡水市'</span>, <span class=\"string\">'省直辖县级行政区划'</span>],</span><br><span class=\"line\">  <span class=\"string\">'山西省'</span>: [<span class=\"string\">'太原市'</span>, <span class=\"string\">'大同市'</span>, <span class=\"string\">'阳泉市'</span>, <span class=\"string\">'长治市'</span>, <span class=\"string\">'晋城市'</span>, <span class=\"string\">'朔州市'</span>, <span class=\"string\">'晋中市'</span>, <span class=\"string\">'运城市'</span>, <span class=\"string\">'忻州市'</span>, <span class=\"string\">'临汾市'</span>, <span class=\"string\">'吕梁市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'内蒙古自治区'</span>: [<span class=\"string\">'呼和浩特市'</span>, <span class=\"string\">'包头市'</span>, <span class=\"string\">'乌海市'</span>, <span class=\"string\">'赤峰市'</span>, <span class=\"string\">'通辽市'</span>, <span class=\"string\">'鄂尔多斯市'</span>, <span class=\"string\">'呼伦贝尔市'</span>, <span class=\"string\">'巴彦淖尔市'</span>, <span class=\"string\">'乌兰察布市'</span>, <span class=\"string\">'兴安盟'</span>, <span class=\"string\">'锡林郭勒盟'</span>, <span class=\"string\">'阿拉善盟'</span>],</span><br><span class=\"line\">  <span class=\"string\">'辽宁省'</span>: [<span class=\"string\">'沈阳市'</span>, <span class=\"string\">'大连市'</span>, <span class=\"string\">'鞍山市'</span>, <span class=\"string\">'抚顺市'</span>, <span class=\"string\">'本溪市'</span>, <span class=\"string\">'丹东市'</span>, <span class=\"string\">'锦州市'</span>, <span class=\"string\">'营口市'</span>, <span class=\"string\">'阜新市'</span>, <span class=\"string\">'辽阳市'</span>, <span class=\"string\">'盘锦市'</span>, <span class=\"string\">'铁岭市'</span>, <span class=\"string\">'朝阳市'</span>, <span class=\"string\">'葫芦岛市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'吉林省'</span>: [<span class=\"string\">'长春市'</span>, <span class=\"string\">'吉林市'</span>, <span class=\"string\">'四平市'</span>, <span class=\"string\">'辽源市'</span>, <span class=\"string\">'通化市'</span>, <span class=\"string\">'白山市'</span>, <span class=\"string\">'松原市'</span>, <span class=\"string\">'白城市'</span>, <span class=\"string\">'延边朝鲜族自治州'</span>],</span><br><span class=\"line\">  <span class=\"string\">'黑龙江省'</span>: [<span class=\"string\">'哈尔滨市'</span>, <span class=\"string\">'齐齐哈尔市'</span>, <span class=\"string\">'鸡西市'</span>, <span class=\"string\">'鹤岗市'</span>, <span class=\"string\">'双鸭山市'</span>, <span class=\"string\">'大庆市'</span>, <span class=\"string\">'伊春市'</span>, <span class=\"string\">'佳木斯市'</span>, <span class=\"string\">'七台河市'</span>, <span class=\"string\">'牡丹江市'</span>, <span class=\"string\">'黑河市'</span>, <span class=\"string\">'绥化市'</span>, <span class=\"string\">'大兴安岭地区'</span>],</span><br><span class=\"line\">  <span class=\"string\">'上海市'</span>: [<span class=\"string\">'市辖区'</span>],</span><br><span class=\"line\">  <span class=\"string\">'江苏省'</span>: [<span class=\"string\">'南京市'</span>, <span class=\"string\">'无锡市'</span>, <span class=\"string\">'徐州市'</span>, <span class=\"string\">'常州市'</span>, <span class=\"string\">'苏州市'</span>, <span class=\"string\">'南通市'</span>, <span class=\"string\">'连云港市'</span>, <span class=\"string\">'淮安市'</span>, <span class=\"string\">'盐城市'</span>, <span class=\"string\">'扬州市'</span>, <span class=\"string\">'镇江市'</span>, <span class=\"string\">'泰州市'</span>, <span class=\"string\">'宿迁市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'浙江省'</span>: [<span class=\"string\">'杭州市'</span>, <span class=\"string\">'宁波市'</span>, <span class=\"string\">'温州市'</span>, <span class=\"string\">'嘉兴市'</span>, <span class=\"string\">'湖州市'</span>, <span class=\"string\">'绍兴市'</span>, <span class=\"string\">'金华市'</span>, <span class=\"string\">'衢州市'</span>, <span class=\"string\">'舟山市'</span>, <span class=\"string\">'台州市'</span>, <span class=\"string\">'丽水市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'安徽省'</span>: [<span class=\"string\">'合肥市'</span>, <span class=\"string\">'芜湖市'</span>, <span class=\"string\">'蚌埠市'</span>, <span class=\"string\">'淮南市'</span>, <span class=\"string\">'马鞍山市'</span>, <span class=\"string\">'淮北市'</span>, <span class=\"string\">'铜陵市'</span>, <span class=\"string\">'安庆市'</span>, <span class=\"string\">'黄山市'</span>, <span class=\"string\">'滁州市'</span>, <span class=\"string\">'阜阳市'</span>, <span class=\"string\">'宿州市'</span>, <span class=\"string\">'六安市'</span>, <span class=\"string\">'亳州市'</span>, <span class=\"string\">'池州市'</span>, <span class=\"string\">'宣城市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'福建省'</span>: [<span class=\"string\">'福州市'</span>, <span class=\"string\">'厦门市'</span>, <span class=\"string\">'莆田市'</span>, <span class=\"string\">'三明市'</span>, <span class=\"string\">'泉州市'</span>, <span class=\"string\">'漳州市'</span>, <span class=\"string\">'南平市'</span>, <span class=\"string\">'龙岩市'</span>, <span class=\"string\">'宁德市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'江西省'</span>: [<span class=\"string\">'南昌市'</span>, <span class=\"string\">'景德镇市'</span>, <span class=\"string\">'萍乡市'</span>, <span class=\"string\">'九江市'</span>, <span class=\"string\">'新余市'</span>, <span class=\"string\">'鹰潭市'</span>, <span class=\"string\">'赣州市'</span>, <span class=\"string\">'吉安市'</span>, <span class=\"string\">'宜春市'</span>, <span class=\"string\">'抚州市'</span>, <span class=\"string\">'上饶市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'山东省'</span>: [<span class=\"string\">'济南市'</span>, <span class=\"string\">'青岛市'</span>, <span class=\"string\">'淄博市'</span>, <span class=\"string\">'枣庄市'</span>, <span class=\"string\">'东营市'</span>, <span class=\"string\">'烟台市'</span>, <span class=\"string\">'潍坊市'</span>, <span class=\"string\">'济宁市'</span>, <span class=\"string\">'泰安市'</span>, <span class=\"string\">'威海市'</span>, <span class=\"string\">'日照市'</span>, <span class=\"string\">'莱芜市'</span>, <span class=\"string\">'临沂市'</span>, <span class=\"string\">'德州市'</span>, <span class=\"string\">'聊城市'</span>, <span class=\"string\">'滨州市'</span>, <span class=\"string\">'菏泽市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'河南省'</span>: [<span class=\"string\">'郑州市'</span>, <span class=\"string\">'开封市'</span>, <span class=\"string\">'洛阳市'</span>, <span class=\"string\">'平顶山市'</span>, <span class=\"string\">'安阳市'</span>, <span class=\"string\">'鹤壁市'</span>, <span class=\"string\">'新乡市'</span>, <span class=\"string\">'焦作市'</span>, <span class=\"string\">'濮阳市'</span>, <span class=\"string\">'许昌市'</span>, <span class=\"string\">'漯河市'</span>, <span class=\"string\">'三门峡市'</span>, <span class=\"string\">'南阳市'</span>, <span class=\"string\">'商丘市'</span>, <span class=\"string\">'信阳市'</span>, <span class=\"string\">'周口市'</span>, <span class=\"string\">'驻马店市'</span>, <span class=\"string\">'省直辖县级行政区划'</span>],</span><br><span class=\"line\">  <span class=\"string\">'湖北省'</span>: [<span class=\"string\">'武汉市'</span>, <span class=\"string\">'黄石市'</span>, <span class=\"string\">'十堰市'</span>, <span class=\"string\">'宜昌市'</span>, <span class=\"string\">'襄阳市'</span>, <span class=\"string\">'鄂州市'</span>, <span class=\"string\">'荆门市'</span>, <span class=\"string\">'孝感市'</span>, <span class=\"string\">'荆州市'</span>, <span class=\"string\">'黄冈市'</span>, <span class=\"string\">'咸宁市'</span>, <span class=\"string\">'随州市'</span>, <span class=\"string\">'恩施土家族苗族自治州'</span>, <span class=\"string\">'省直辖县级行政区划'</span>],</span><br><span class=\"line\">  <span class=\"string\">'湖南省'</span>: [<span class=\"string\">'长沙市'</span>, <span class=\"string\">'株洲市'</span>, <span class=\"string\">'湘潭市'</span>, <span class=\"string\">'衡阳市'</span>, <span class=\"string\">'邵阳市'</span>, <span class=\"string\">'岳阳市'</span>, <span class=\"string\">'常德市'</span>, <span class=\"string\">'张家界市'</span>, <span class=\"string\">'益阳市'</span>, <span class=\"string\">'郴州市'</span>, <span class=\"string\">'永州市'</span>, <span class=\"string\">'怀化市'</span>, <span class=\"string\">'娄底市'</span>, <span class=\"string\">'湘西土家族苗族自治州'</span>],</span><br><span class=\"line\">  <span class=\"string\">'广东省'</span>: [<span class=\"string\">'广州市'</span>, <span class=\"string\">'韶关市'</span>, <span class=\"string\">'深圳市'</span>, <span class=\"string\">'珠海市'</span>, <span class=\"string\">'汕头市'</span>, <span class=\"string\">'佛山市'</span>, <span class=\"string\">'江门市'</span>, <span class=\"string\">'湛江市'</span>, <span class=\"string\">'茂名市'</span>, <span class=\"string\">'肇庆市'</span>, <span class=\"string\">'惠州市'</span>, <span class=\"string\">'梅州市'</span>, <span class=\"string\">'汕尾市'</span>, <span class=\"string\">'河源市'</span>, <span class=\"string\">'阳江市'</span>, <span class=\"string\">'清远市'</span>, <span class=\"string\">'东莞市'</span>, <span class=\"string\">'中山市'</span>, <span class=\"string\">'潮州市'</span>, <span class=\"string\">'揭阳市'</span>, <span class=\"string\">'云浮市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'广西壮族自治区'</span>: [<span class=\"string\">'南宁市'</span>, <span class=\"string\">'柳州市'</span>, <span class=\"string\">'桂林市'</span>, <span class=\"string\">'梧州市'</span>, <span class=\"string\">'北海市'</span>, <span class=\"string\">'防城港市'</span>, <span class=\"string\">'钦州市'</span>, <span class=\"string\">'贵港市'</span>, <span class=\"string\">'玉林市'</span>, <span class=\"string\">'百色市'</span>, <span class=\"string\">'贺州市'</span>, <span class=\"string\">'河池市'</span>, <span class=\"string\">'来宾市'</span>, <span class=\"string\">'崇左市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'海南省'</span>: [<span class=\"string\">'海口市'</span>, <span class=\"string\">'三亚市'</span>, <span class=\"string\">'三沙市'</span>, <span class=\"string\">'儋州市'</span>, <span class=\"string\">'省直辖县级行政区划'</span>],</span><br><span class=\"line\">  <span class=\"string\">'重庆市'</span>: [<span class=\"string\">'市辖区'</span>, <span class=\"string\">'县'</span>],</span><br><span class=\"line\">  <span class=\"string\">'四川省'</span>: [<span class=\"string\">'成都市'</span>, <span class=\"string\">'自贡市'</span>, <span class=\"string\">'攀枝花市'</span>, <span class=\"string\">'泸州市'</span>, <span class=\"string\">'德阳市'</span>, <span class=\"string\">'绵阳市'</span>, <span class=\"string\">'广元市'</span>, <span class=\"string\">'遂宁市'</span>, <span class=\"string\">'内江市'</span>, <span class=\"string\">'乐山市'</span>, <span class=\"string\">'南充市'</span>, <span class=\"string\">'眉山市'</span>, <span class=\"string\">'宜宾市'</span>, <span class=\"string\">'广安市'</span>, <span class=\"string\">'达州市'</span>, <span class=\"string\">'雅安市'</span>, <span class=\"string\">'巴中市'</span>, <span class=\"string\">'资阳市'</span>, <span class=\"string\">'阿坝藏族羌族自治州'</span>, <span class=\"string\">'甘孜藏族自治州'</span>, <span class=\"string\">'凉山彝族自治州'</span>],</span><br><span class=\"line\">  <span class=\"string\">'贵州省'</span>: [<span class=\"string\">'贵阳市'</span>, <span class=\"string\">'六盘水市'</span>, <span class=\"string\">'遵义市'</span>, <span class=\"string\">'安顺市'</span>, <span class=\"string\">'毕节市'</span>, <span class=\"string\">'铜仁市'</span>, <span class=\"string\">'黔西南布依族苗族自治州'</span>, <span class=\"string\">'黔东南苗族侗族自治州'</span>, <span class=\"string\">'黔南布依族苗族自治州'</span>],</span><br><span class=\"line\">  <span class=\"string\">'云南省'</span>: [<span class=\"string\">'昆明市'</span>, <span class=\"string\">'曲靖市'</span>, <span class=\"string\">'玉溪市'</span>, <span class=\"string\">'保山市'</span>, <span class=\"string\">'昭通市'</span>, <span class=\"string\">'丽江市'</span>, <span class=\"string\">'普洱市'</span>, <span class=\"string\">'临沧市'</span>, <span class=\"string\">'楚雄彝族自治州'</span>, <span class=\"string\">'红河哈尼族彝族自治州'</span>, <span class=\"string\">'文山壮族苗族自治州'</span>, <span class=\"string\">'西双版纳傣族自治州'</span>, <span class=\"string\">'大理白族自治州'</span>, <span class=\"string\">'德宏傣族景颇族自治州'</span>, <span class=\"string\">'怒江傈僳族自治州'</span>, <span class=\"string\">'迪庆藏族自治州'</span>],</span><br><span class=\"line\">  <span class=\"string\">'西藏自治区'</span>: [<span class=\"string\">'拉萨市'</span>, <span class=\"string\">'日喀则市'</span>, <span class=\"string\">'昌都市'</span>, <span class=\"string\">'林芝市'</span>, <span class=\"string\">'山南市'</span>, <span class=\"string\">'那曲地区'</span>, <span class=\"string\">'阿里地区'</span>],</span><br><span class=\"line\">  <span class=\"string\">'陕西省'</span>: [<span class=\"string\">'西安市'</span>, <span class=\"string\">'铜川市'</span>, <span class=\"string\">'宝鸡市'</span>, <span class=\"string\">'咸阳市'</span>, <span class=\"string\">'渭南市'</span>, <span class=\"string\">'延安市'</span>, <span class=\"string\">'汉中市'</span>, <span class=\"string\">'榆林市'</span>, <span class=\"string\">'安康市'</span>, <span class=\"string\">'商洛市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'甘肃省'</span>: [<span class=\"string\">'兰州市'</span>, <span class=\"string\">'嘉峪关市'</span>, <span class=\"string\">'金昌市'</span>, <span class=\"string\">'白银市'</span>, <span class=\"string\">'天水市'</span>, <span class=\"string\">'武威市'</span>, <span class=\"string\">'张掖市'</span>, <span class=\"string\">'平凉市'</span>, <span class=\"string\">'酒泉市'</span>, <span class=\"string\">'庆阳市'</span>, <span class=\"string\">'定西市'</span>, <span class=\"string\">'陇南市'</span>, <span class=\"string\">'临夏回族自治州'</span>, <span class=\"string\">'甘南藏族自治州'</span>],</span><br><span class=\"line\">  <span class=\"string\">'青海省'</span>: [<span class=\"string\">'西宁市'</span>, <span class=\"string\">'海东市'</span>, <span class=\"string\">'海北藏族自治州'</span>, <span class=\"string\">'黄南藏族自治州'</span>, <span class=\"string\">'海南藏族自治州'</span>, <span class=\"string\">'果洛藏族自治州'</span>, <span class=\"string\">'玉树藏族自治州'</span>, <span class=\"string\">'海西蒙古族藏族自治州'</span>],</span><br><span class=\"line\">  <span class=\"string\">'宁夏回族自治区'</span>: [<span class=\"string\">'银川市'</span>, <span class=\"string\">'石嘴山市'</span>, <span class=\"string\">'吴忠市'</span>, <span class=\"string\">'固原市'</span>, <span class=\"string\">'中卫市'</span>],</span><br><span class=\"line\">  <span class=\"string\">'新疆维吾尔自治区'</span>: [<span class=\"string\">'乌鲁木齐市'</span>, <span class=\"string\">'克拉玛依市'</span>, <span class=\"string\">'吐鲁番市'</span>, <span class=\"string\">'哈密市'</span>, <span class=\"string\">'昌吉回族自治州'</span>, <span class=\"string\">'博尔塔拉蒙古自治州'</span>, <span class=\"string\">'巴音郭楞蒙古自治州'</span>, <span class=\"string\">'阿克苏地区'</span>, <span class=\"string\">'克孜勒苏柯尔克孜自治州'</span>, <span class=\"string\">'喀什地区'</span>, <span class=\"string\">'和田地区'</span>, <span class=\"string\">'伊犁哈萨克自治州'</span>, <span class=\"string\">'塔城地区'</span>, <span class=\"string\">'阿勒泰地区'</span>, <span class=\"string\">'自治区直辖县级行政区划'</span>],</span><br><span class=\"line\">  <span class=\"string\">'台湾省'</span>: [<span class=\"string\">'台湾'</span>],</span><br><span class=\"line\">  <span class=\"string\">'香港特别行政区'</span>: [<span class=\"string\">'香港'</span>],</span><br><span class=\"line\">  <span class=\"string\">'澳门特别行政区'</span>: [<span class=\"string\">'澳门'</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">module.exports = citys;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">region-widget.js</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">var raw = require(<span class=\"string\">'../../../utils/citys'</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">Component(&#123;</span><br><span class=\"line\">  options: &#123;</span><br><span class=\"line\">    multipleSlots: <span class=\"literal\">true</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  data: &#123;</span><br><span class=\"line\">    select:[0,0],</span><br><span class=\"line\">    region: [Object.keys(raw), raw[Object.keys(raw)[0]]],</span><br><span class=\"line\">    province:<span class=\"string\">\"\"</span>,</span><br><span class=\"line\">    city:<span class=\"string\">\"\"</span></span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  properties: &#123;</span><br><span class=\"line\">    target: &#123;</span><br><span class=\"line\">      <span class=\"built_in\">type</span>: Array,</span><br><span class=\"line\">      value: [],</span><br><span class=\"line\">      observer: <span class=\"string\">'update'</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  methods: &#123;</span><br><span class=\"line\">    update: <span class=\"keyword\">function</span> (newVal, oldVal) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span>(!newVal || newVal.length &lt; 2)<span class=\"built_in\">return</span>;</span><br><span class=\"line\">      var province = newVal[0];</span><br><span class=\"line\">      var city = newVal[1];</span><br><span class=\"line\">      var region = this.data.region;</span><br><span class=\"line\">      //update province</span><br><span class=\"line\">      var pro_index = region[0].indexOf(province);</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (pro_index &lt; 0)<span class=\"built_in\">return</span>;</span><br><span class=\"line\">      region = [region[0], raw[province]];</span><br><span class=\"line\">      //update city</span><br><span class=\"line\">      var city_index = region[1].indexOf(city);</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (city_index &lt; 0) <span class=\"built_in\">return</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">      this.setData(&#123;</span><br><span class=\"line\">        select: [pro_index,city_index],</span><br><span class=\"line\">        region: region,</span><br><span class=\"line\">        province: province,</span><br><span class=\"line\">        city: city</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    bindChange: <span class=\"keyword\">function</span> (e) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (!e.detail.value || e.detail.value.length &lt;2)<span class=\"built_in\">return</span>;</span><br><span class=\"line\">      var region = this.data.region;</span><br><span class=\"line\">      var pro_index = e.detail.value[0];</span><br><span class=\"line\">      var city_index = e.detail.value[1];</span><br><span class=\"line\">      this.setData(&#123;</span><br><span class=\"line\">        province: region[0][pro_index],</span><br><span class=\"line\">        city: region[1][city_index]</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">      this.notify();</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    bindColumnChange: <span class=\"keyword\">function</span> (e) &#123;</span><br><span class=\"line\">      <span class=\"keyword\">if</span> (e.detail.column === 0) &#123;</span><br><span class=\"line\">        var region = this.data.region;</span><br><span class=\"line\">        var province = region[0][e.detail.value];</span><br><span class=\"line\">        this.setData(&#123; </span><br><span class=\"line\">          region: [region[0], raw[province]] </span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;,</span><br><span class=\"line\">    <span class=\"function\"><span class=\"title\">notify</span></span>() &#123;</span><br><span class=\"line\">      this.triggerEvent(<span class=\"string\">'regionChange'</span>, &#123; province: this.data.province, city: this.data.city &#125;, &#123;&#125;)</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">region-widget.wxml</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;picker </span><br><span class=\"line\">  mode=<span class=\"string\">\"multiSelector\"</span> </span><br><span class=\"line\">  value=<span class=\"string\">\"&#123;&#123;select&#125;&#125;\"</span> </span><br><span class=\"line\">  range=<span class=\"string\">\"&#123;&#123;region&#125;&#125;\"</span></span><br><span class=\"line\">  bindchange=<span class=\"string\">\"bindChange\"</span> </span><br><span class=\"line\">  bindcolumnchange=<span class=\"string\">\"bindColumnChange\"</span>&gt;</span><br><span class=\"line\">  &lt;slot&gt;&lt;/slot&gt;</span><br><span class=\"line\">&lt;/picker&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">region-widget.json</span><br></pre></td></tr></table></figure>\n<p>将此选择器组件化<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"component\"</span>: <span class=\"literal\">true</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<p>用法是(组件的引用)：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use.json</span><br></pre></td></tr></table></figure></p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  <span class=\"string\">\"usingComponents\"</span>: &#123;</span><br><span class=\"line\">    <span class=\"string\">\"region-widget\"</span>: <span class=\"string\">\"./region-widget\"</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use.wxml</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;region-widget target=<span class=\"string\">\"&#123;&#123;select&#125;&#125;\"</span> bindregionChange=<span class=\"string\">\"onRegionChange\"</span>&gt;</span><br><span class=\"line\">    &lt;text&gt;&#123;&#123;select[0]&#125;&#125;&#123;&#123;select[1]&#125;&#125;&lt;/text&gt;</span><br><span class=\"line\">&lt;/region-widget&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use.js</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Page(&#123;</span><br><span class=\"line\">  data: &#123;</span><br><span class=\"line\">      select:[<span class=\"string\">\"广东省\"</span>,<span class=\"string\">\"广州市\"</span>]</span><br><span class=\"line\">  &#125;,</span><br><span class=\"line\">  onRegionChange:<span class=\"keyword\">function</span>(e)&#123;</span><br><span class=\"line\">    console.log(e.detail);</span><br><span class=\"line\">    this.setData(&#123;select: [e.detail.province, e.detail.city]&#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>","categories":[],"tags":[]}