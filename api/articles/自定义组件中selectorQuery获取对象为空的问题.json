{"title":"自定义组件中selectorQuery获取对象为空的问题","slug":"自定义组件中selectorQuery获取对象为空的问题","date":"2018-12-12T06:53:30.000Z","updated":"2019-04-23T07:55:20.589Z","comments":true,"excerpt":"","content":"<p>wx.createSelectorQuery()是微信小程序节点的查询方法，使用方法API文档也已经列出了示例代码：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">const query = wx.createSelectorQuery()</span><br><span class=\"line\">query.select(<span class=\"string\">'#the-id'</span>).boundingClientRect()</span><br><span class=\"line\">query.selectViewport().scrollOffset()</span><br><span class=\"line\">query.exec(<span class=\"keyword\">function</span> (res) &#123;</span><br><span class=\"line\">  res[0].top // <span class=\"comment\">#the-id节点的上边界坐标</span></span><br><span class=\"line\">  res[1].scrollTop // 显示区域的竖直滚动位置</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n<p>但是在自定义组件内，直接使用是无法获取到节点的，需要将选择器的选取范围更改为自定义组件component内。（初始时，选择器仅选取页面范围的节点，不会选取任何自定义组件中的节点。）<br>示例代码：<br><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Component(&#123;</span><br><span class=\"line\">  ready(): <span class=\"function\"><span class=\"title\">function</span></span>()&#123;</span><br><span class=\"line\">    var query = wx.createSelectorQuery().<span class=\"keyword\">in</span>(this)</span><br><span class=\"line\">    query.select(<span class=\"string\">'#the-id'</span>).boundingClientRect(<span class=\"keyword\">function</span>(res)&#123;</span><br><span class=\"line\">      res</span><br><span class=\"line\">    &#125;).<span class=\"built_in\">exec</span>()</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;)</span><br></pre></td></tr></table></figure></p>\n","categories":[],"tags":[]}